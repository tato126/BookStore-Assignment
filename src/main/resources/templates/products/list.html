<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <meta charset="UTF-8"/>
  <title>상품 목록</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px 12px; border-bottom: 1px solid #e5e7eb; text-align: left; }
    th { background: #f9fafb; }
    .toolbar { margin-bottom: 16px; display: flex; gap: 8px; }
    .btn { display:inline-block; padding:8px 12px; border:1px solid #d1d5db; border-radius:8px; text-decoration:none; }

    /* 페이지네이션 스타일 */
    .pagination-container {
      margin-top: 24px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
    }
    .pagination-info {
      color: #6b7280;
      font-size: 14px;
    }
    .pagination {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .page-link {
      display: inline-block;
      padding: 8px 12px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      text-decoration: none;
      color: #374151;
      transition: all 0.2s;
    }
    .page-link:hover:not(.disabled):not(.active) {
      background: #f3f4f6;
      border-color: #9ca3af;
    }
    .page-link.active {
      background: #3b82f6;
      color: white;
      border-color: #3b82f6;
      font-weight: 600;
    }
    .page-link.disabled {
      color: #d1d5db;
      cursor: not-allowed;
      pointer-events: none;
    }
  </style>
</head>
<body>
<h1>현재 판매 중인 도서 📚</h1>

<div class="toolbar">
  <a class="btn" th:href="@{/admin/product/register}">+ 상품 등록</a>
  <a class="btn" th:href="@{/products/list}">홈으로</a>
</div>

<table>
  <thead>
  <tr>
    <th>ID</th>
    <th>상품명</th>
    <th>책 표지</th>
    <th>설명</th>
    <th>가격</th>
    <th>재고</th>
    <th>등록일</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="p : ${products}">
    <td th:text="${p.productId}">1</td>
    <td>
      <a th:href="@{|/products/${p.productId}|}" th:text="${p.productName}">예시상품</a>
    </td>
    <td>
      <img th:src="${p.imageUrl}" alt="책 이미지" style="max-width:80px; height:auto; display:block; margin-top:4px;"/>
    </td>
    <td th:text="${p.description}">설명</td>
    <td th:text="${#numbers.formatInteger(p.price, 0, 'COMMA')} + '원'">10,000원</td>
    <td th:text="${p.stockQuantity}">5</td>
    <td th:text="${#temporals.format(p.createdAt, 'yyyy년 MM월 dd일 HH시 mm분 ss초')}">2025년 09월 14일 18시 20분 12초</td>
  </tr>
  <tr th:if="${#lists.isEmpty(products)}">
    <td colspan="7">등록된 상품이 없습니다.</td>
  </tr>
  </tbody>
</table>

<!-- 페이지네이션 -->
<div class="pagination-container" th:if="${page != null && page.totalPages > 0}">
  <!-- 페이지 정보 -->
  <div class="pagination-info">
    전체 <strong th:text="${page.totalElements}">0</strong>개 상품 중
    <strong th:text="${page.number * page.size + 1}">1</strong> -
    <strong th:text="${(page.number + 1) * page.size > page.totalElements ? page.totalElements : (page.number + 1) * page.size}">30</strong>개 표시
    (페이지 <strong th:text="${page.number + 1}">1</strong> / <strong th:text="${page.totalPages}">1</strong>)
  </div>

  <!-- 페이지 네비게이션 -->
  <div class="pagination">
    <!-- 이전 버튼 -->
    <a th:href="@{/(page=${page.number - 1}, size=${page.size})}"
       th:class="${page.hasPrevious()} ? 'page-link' : 'page-link disabled'"
       th:if="${page.hasPrevious() || page.number > 0}">
      ← 이전
    </a>
    <span class="page-link disabled" th:unless="${page.hasPrevious() || page.number > 0}">
      ← 이전
    </span>

    <!-- 페이지 번호들 -->
    <th:block th:with="
      startPage=${page.number - 2 < 0 ? 0 : page.number - 2},
      endPage=${page.number + 2 >= page.totalPages ? page.totalPages - 1 : page.number + 2}">

      <!-- 첫 페이지 -->
      <a th:if="${startPage > 0}"
         th:href="@{/(page=0, size=${page.size})}"
         class="page-link">1</a>
      <span th:if="${startPage > 1}" class="page-link disabled">...</span>

      <!-- 중간 페이지들 -->
      <th:block th:each="i : ${#numbers.sequence(startPage, endPage)}">
        <a th:href="@{/(page=${i}, size=${page.size})}"
           th:text="${i + 1}"
           th:class="${i == page.number} ? 'page-link active' : 'page-link'">1</a>
      </th:block>

      <!-- 마지막 페이지 -->
      <span th:if="${endPage < page.totalPages - 2}" class="page-link disabled">...</span>
      <a th:if="${endPage < page.totalPages - 1}"
         th:href="@{/(page=${page.totalPages - 1}, size=${page.size})}"
         th:text="${page.totalPages}"
         class="page-link">10</a>
    </th:block>

    <!-- 다음 버튼 -->
    <a th:href="@{/(page=${page.number + 1}, size=${page.size})}"
       th:class="${page.hasNext()} ? 'page-link' : 'page-link disabled'"
       th:if="${page.hasNext()}">
      다음 →
    </a>
    <span class="page-link disabled" th:unless="${page.hasNext()}">
      다음 →
    </span>
  </div>
</div>

</body>
</html>